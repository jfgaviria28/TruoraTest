# RAG Document: Web & Product Analytics Overview

## 1. High-Level Gist

This document provides a general overview of the three "Analytics Events" datasets in this project:
- `raw_ga4_sessions.csv`
- `raw_segment_events.csv`
- `raw_mixpanel_events.csv`

These files simulate data from web and product analytics platforms. Unlike the ad platforms, which focus on spend and high-level campaign metrics, these sources track user-level activity, such as page views, specific events (e.g., 'signup'), and user sessions.

**Core Purpose**: To provide a granular view of user behavior and link it back to the marketing campaigns that acquired them. This data is essential for understanding user journeys and conversion events.

**Agent's Goal**: The primary task for an AI agent is to ingest, standardize, and connect this user-level data to the higher-level ad platform data. The agent must handle variations in event schemas, naming conventions, and identifiers to build a complete picture of the user funnel.

## 2. Shared Key Concepts & Columns

These platforms track user interactions, so their schemas are built around users, sessions, and events.

### `user_uid` (or equivalent)
- **What it is**: A unique identifier for a single user across different sessions and platforms.
- **Role**: This is a critical **foreign key**. It's the primary means of linking a user's web activity (`GA4`) to their product activity (`Mixpanel`, `Segment`) and ultimately to their lead/customer profile (`HubSpot`, `Stripe`).
- **Clean Data**: Always present, named `user_uid`.
- **Realistic Data**: May have a different name (e.g., `uid` in Segment). Crucially, it may also be **missing** (`NULL`) for some events, representing anonymous or untracked users.

### `session_id` (or equivalent)
- **What it is**: A unique identifier for a single user visit or session. A user can have multiple sessions.
- **What it is used for**: It groups a series of events from a single visit. It can be linked to `campaign_id` to attribute a session to a marketing campaign.
- **Clean Data**: Standard `session_id`.
- **Realistic Data**: Naming can vary (`sessionId`). The format can be inconsistent, with some malformed IDs introduced in the entropy script.

### `event_date` (or equivalent)
- **What it is**: The date on which the user session or event occurred.
- **Role**: The primary time-series field for user activity.
- **Clean Data**: Standard ISO format (`YYYY-MM-DD`), named `date`.
- **Realistic Data**: Naming varies (`event_date`, `ts`). The format is generally consistent (`YYYY-MM-DD`), but the agent should always verify.

### Event-Specific Data
- **What it is**: These columns describe the specific action the user took.
- **Clean Data**: Varies by source, e.g., `conv_flag` in GA4, `event_name` in Mixpanel.
- **Realistic Data**: The structure and naming can be very different. Segment, for example, uses a `properties_json` blob to store event details, requiring the agent to parse JSON.

## 3. Data Generation Logic (`make_data.py`)

The clean data for these platforms is generated by the `build_sessions()` function in `generator/make_data.py`.

- **Volume**: The script generates **24,000 rows** for each of the three analytics platforms.
- **User and Session IDs**: Both `user_uid` and `session_id` are generated using `uuid.uuid4().hex[:10]`, creating random, unique identifiers.
- **Campaign Attribution**: Each session is randomly associated with a `campaign_id`, simulating how an analytics platform would attribute a user's visit to a marketing campaign.
- **Event Variation**: The function has conditional logic to create different schemas for each source, simulating the different ways these platforms structure their data (e.g., `event_name` vs. `event_json`).

## 4. Key Takeaways for AI Agent

- **User-Centric View**: The agent's focus should shift from a campaign-centric view (ad platforms) to a user-centric view. The `user_uid` is the most important identifier in these files.
- **Schema Unification is a Major Challenge**: Unlike the ad platforms, the schemas here are fundamentally different. The agent will need to perform significant transformation to create a unified "events" table. For example, it will need to parse the `properties_json` from Segment to extract a consistent event type.
- **Handle Missing `user_uid`**: The presence of `NULL` user IDs is a key feature of the realistic data. The agent must decide on a strategy for handling these anonymous events (e.g., keep them for aggregate analysis or filter them out for user-level joins).
- **Consult Specific Docs**: This overview provides the general context, but the agent MUST consult the specific RAG documents for `raw_ga4_sessions.md`, `raw_segment_events.md`, and `raw_mixpanel_events.md` to understand their unique entropy and cleaning requirements. 